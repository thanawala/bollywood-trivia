
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bollywood Trivia Engine</title>
    <!-- CSS and Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    
    <!-- Runtime Transpiler -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.2.4",
    "react-dom/client": "https://esm.sh/react-dom@19.2.4/client",
    "@google/genai": "https://esm.sh/@google/genai@1.41.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: #0a0f1e;
            color: #f8fafc;
            margin: 0;
            overflow-x: hidden;
        }
        .bollywood-font { font-family: 'Cinzel Decorative', cursive; }
        .gradient-text {
            background: linear-gradient(to right, #fbbf24, #ef4444, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }
        .glass-panel {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(245, 158, 11, 0.2); border-radius: 10px; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade { animation: fadeIn 0.5s ease-out forwards; }
        
        /* Premium button hover effect */
        .btn-glow:hover {
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.3);
            filter: brightness(1.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState } from 'react';
        import ReactDOM from 'react-dom/client';
        import { GoogleGenAI } from "@google/genai";

        // ============================================================
        //  LOCAL VAULT DATA (Edit names here, one per line)
        // ============================================================
        const INITIAL_DATA = {
            'Movies': `Dilwale Dulhania Le Jayenge
Zindagi Na Milegi Dobara
Lagaan: Once Upon a Time in India
Kabhi Khushi Kabhie Gham
Gangs of Wasseypur
Sholay
3 Idiots
Bajrangi Bhaijaan
Dil Chahta Hai
Kal Ho Naa Ho
Kuch Kuch Hota Hai
Pathaan
Jawan
Rocky Aur Rani Kii Prem Kahaani
Brahmastra: Part One - Shiva
Andhadhun
Drishyam 2`,
            
            'Actors': `Shah Rukh Khan
Amitabh Bachchan
Aamir Khan
Salman Khan
Deepika Padukone
Priyanka Chopra Jonas
Ranbir Kapoor
Ranveer Singh
Alia Bhatt
Hrithik Roshan
Naseeruddin Shah
Pankaj Tripathi`,

            'Songs': `Chaiyya Chaiyya
Tum Hi Ho
Kal Ho Naa Ho
Kesariya Tera Ishq Hai Piya
Tujhe Dekha To Yeh Jaana Sanam
Gerua
Kabira
Deewani Mastani
Pee Loon
Jhoome Jo Pathaan`,

            'Music Directors': `A. R. Rahman
Pritam Chakraborty
Vishal-Shekhar
Shankar-Ehsaan-Loy
Amit Trivedi
Mithoon
R. D. Burman
S. D. Burman
Laxmikant-Pyarelal`,

            'Directors': `Sanjay Leela Bhansali
Rajkumar Hirani
Zoya Akhtar
Anurag Kashyap
Karan Johar
Imtiaz Ali
Aditya Chopra
Farhan Akhtar
S. S. Rajamouli
Mani Ratnam`
        };

        const Categories = {
            MOVIES: 'Movies',
            ACTORS: 'Actors',
            SONGS: 'Songs',
            MUSIC_DIRECTORS: 'Music Directors',
            DIRECTORS: 'Directors'
        };

        const App = () => {
            const [category, setCategory] = useState(Categories.MOVIES);
            const [searchMode, setSearchMode] = useState('local');
            const [minWords, setMinWords] = useState(1);
            const [result, setResult] = useState(null);
            const [loading, setLoading] = useState(false);
            const [history, setHistory] = useState([]);
            const [error, setError] = useState(null);
            const [localScripts, setLocalScripts] = useState(INITIAL_DATA);
            const [showEditor, setShowEditor] = useState(false);

            const handleGenerate = async () => {
                setLoading(true);
                setError(null);
                setResult(null);

                if (searchMode === 'local') {
                    const names = (localScripts[category] || "").split('\n').map(n => n.trim()).filter(n => n.length > 0);
                    const filtered = names.filter(name => {
                        const words = name.split(/\s+/).filter(w => w.length > 0);
                        return words.length >= minWords;
                    });

                    if (filtered.length === 0) {
                        setError(names.length === 0 ? "Your local vault is empty." : `No ${category} in your list has ${minWords}+ words.`);
                        setLoading(false);
                        return;
                    }

                    await new Promise(r => setTimeout(r, 600));
                    const picked = filtered[Math.floor(Math.random() * filtered.length)];
                    setResult(picked);
                    setHistory(prev => [{ name: picked, category, timestamp: Date.now() }, ...prev].slice(0, 5));
                    setLoading(false);
                } else {
                    try {
                        // Strict adherence to process.env.API_KEY rule
                        // Browser environments without build tools will throw here if 'process' is undefined
                        if (typeof process === 'undefined') {
                            throw new Error("Internet Mode Error: 'process.env.API_KEY' is not defined in this browser context. Please use Local Vault or deploy with a build step.");
                        }

                        const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });
                        const response = await ai.models.generateContent({
                            model: 'gemini-3-flash-preview',
                            contents: `Provide a random name for the category: "${category}". 
                            Constraint: Only return the name itself. 
                            Constraint: The name MUST contain at least ${minWords} words.`
                        });

                        const text = response.text?.trim();
                        if (text) {
                            setResult(text);
                            setHistory(prev => [{ name: text, category, timestamp: Date.now() }, ...prev].slice(0, 5));
                        }
                    } catch (err) {
                        console.error("Gemini Error:", err);
                        setError(err.message || "Engine failure. Check your Vercel logs or use Local Vault.");
                    } finally {
                        setLoading(false);
                    }
                }
            };

            return (
                <div className="min-h-screen flex flex-col items-center p-6 md:p-12 relative overflow-hidden bg-[#0a0f1e]">
                    {/* Visual Ambience */}
                    <div className="absolute top-[-10%] left-[-10%] w-[60%] h-[60%] bg-amber-500/10 rounded-full blur-[120px] pointer-events-none"></div>
                    <div className="absolute bottom-[-10%] right-[-10%] w-[60%] h-[60%] bg-rose-500/10 rounded-full blur-[120px] pointer-events-none"></div>

                    <header className="text-center mb-10 z-10 animate-fade">
                        <h1 className="bollywood-font">
                            <span className="text-4xl md:text-6xl uppercase gradient-text leading-tight drop-shadow-lg">Bollywood</span><br/>
                            <span className="text-xl md:text-3xl uppercase gradient-text tracking-[0.2em]">Data Engine</span>
                        </h1>
                        <p className="text-slate-500 text-[10px] uppercase tracking-[0.4em] mt-4 opacity-50 font-semibold">
                            {searchMode === 'internet' ? 'Live AI Streaming' : 'Offline Vault Active'}
                        </p>
                    </header>

                    <main className="w-full max-w-2xl z-10 space-y-6">
                        <div className="glass-panel p-6 md:p-10 rounded-[2.5rem] shadow-2xl space-y-8 border border-white/10">
                            {/* Mode Switcher */}
                            <div className="grid grid-cols-2 bg-slate-950/80 p-1 rounded-2xl border border-white/5 shadow-inner">
                                {['internet', 'local'].map(m => (
                                    <button 
                                        key={m} 
                                        onClick={() => setSearchMode(m)} 
                                        className={`py-3 rounded-xl text-[10px] font-bold uppercase tracking-widest transition-all ${searchMode === m ? 'bg-amber-500 text-slate-950 shadow-lg' : 'text-slate-500 hover:text-white'}`}
                                    >
                                        <i className={`fas ${m === 'internet' ? 'fa-globe' : 'fa-box-open'} mr-2 opacity-50`}></i>
                                        {m}
                                    </button>
                                ))}
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="space-y-2">
                                    <label className="text-[10px] uppercase tracking-widest text-amber-500 font-bold opacity-70">Target Category</label>
                                    <div className="relative">
                                        <select 
                                            value={category} 
                                            onChange={e => setCategory(e.target.value)} 
                                            className="w-full bg-slate-900/60 border border-white/10 rounded-xl px-4 py-3 text-white appearance-none cursor-pointer focus:border-amber-500/50 outline-none shadow-sm"
                                        >
                                            {Object.values(Categories).map(c => <option key={c} value={c} className="bg-slate-900">{c}</option>)}
                                        </select>
                                        <i className="fas fa-chevron-down absolute right-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-[10px]"></i>
                                    </div>
                                </div>
                                <div className="space-y-2">
                                    <label className="text-[10px] uppercase tracking-widest text-amber-500 font-bold opacity-70">Minimum Words: {minWords}</label>
                                    <div className="flex bg-slate-900/60 p-1 rounded-xl border border-white/10">
                                        {[1, 2, 3, 4].map(n => (
                                            <button 
                                                key={n} 
                                                onClick={() => setMinWords(n)} 
                                                className={`flex-1 py-2 rounded-lg text-xs font-mono transition-all ${minWords === n ? 'bg-white/10 text-amber-400' : 'text-slate-600 hover:text-slate-400'}`}
                                            >
                                                {n}+
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            <button 
                                onClick={handleGenerate} 
                                disabled={loading} 
                                className={`btn-glow w-full py-5 rounded-2xl text-lg font-bold tracking-[0.2em] uppercase transition-all shadow-xl active:scale-95 ${loading ? 'bg-slate-800 text-slate-500 cursor-not-allowed' : 'bg-gradient-to-r from-amber-500 via-orange-500 to-rose-600 text-slate-950'}`}
                            >
                                {loading ? <i className="fas fa-spinner fa-spin mr-2"></i> : <i className="fas fa-play mr-2 text-sm opacity-50"></i>}
                                {loading ? 'Processing...' : 'Run Engine'}
                            </button>

                            {(result || error) && (
                                <div className={`p-8 rounded-[2rem] border-2 text-center animate-fade ${error ? 'border-red-500/20 bg-red-500/5 text-red-400' : 'border-amber-500/20 bg-amber-500/5'}`}>
                                    {error ? (
                                        <div className="space-y-2">
                                            <i className="fas fa-triangle-exclamation text-xl mb-1 opacity-50"></i>
                                            <p className="text-[10px] uppercase tracking-widest leading-relaxed font-semibold">{error}</p>
                                        </div>
                                    ) : (
                                        <>
                                            <p className="text-[8px] uppercase tracking-[0.5em] text-amber-500/40 mb-3">RESULT OBTAINED</p>
                                            <h2 className="text-3xl md:text-5xl font-bold bollywood-font text-white leading-tight break-words drop-shadow-lg">{result}</h2>
                                        </>
                                    )}
                                </div>
                            )}

                            <div className="text-center pt-4">
                                <button 
                                    onClick={() => setShowEditor(!showEditor)} 
                                    className="inline-flex items-center gap-2 text-[10px] uppercase tracking-widest text-slate-500 hover:text-amber-500 transition-colors"
                                >
                                    <i className={`fas ${showEditor ? 'fa-times' : 'fa-database'}`}></i>
                                    {showEditor ? 'Close Data Editor' : 'Manage Local Vault'}
                                </button>
                            </div>

                            {showEditor && (
                                <div className="space-y-4 animate-fade border-t border-white/5 pt-6">
                                    <div className="flex justify-between items-center text-[9px] uppercase tracking-widest text-slate-400 font-bold">
                                        <span>Editing Vault: {category}</span>
                                        <button onClick={() => setLocalScripts(p => ({...p, [category]: ""}))} className="text-rose-500 hover:text-rose-400">Clear List</button>
                                    </div>
                                    <textarea 
                                        value={localScripts[category]} 
                                        onChange={e => setLocalScripts(p => ({...p, [category]: e.target.value}))}
                                        placeholder={`Enter your ${category.toLowerCase()} here, one per line...`}
                                        className="w-full h-40 bg-black/40 border border-white/5 rounded-2xl p-4 text-xs font-mono text-amber-100/70 focus:border-amber-500/30 outline-none resize-none custom-scrollbar"
                                    />
                                    <p className="text-[9px] text-slate-600 italic">Names in this list will be picked when "Local" mode is active.</p>
                                </div>
                            )}
                        </div>

                        {history.length > 0 && (
                            <div className="animate-fade space-y-3">
                                <h3 className="text-[10px] font-bold uppercase tracking-widest text-amber-500/30 flex items-center gap-2 px-2">
                                    <i className="fas fa-history"></i> Discovery Log
                                </h3>
                                {history.map(item => (
                                    <div key={item.timestamp} className="glass-panel p-4 rounded-2xl flex justify-between items-center border border-white/5 group transition-all hover:bg-white/5">
                                        <div>
                                            <p className="text-white text-sm font-semibold">{item.name}</p>
                                            <p className="text-[9px] text-slate-500 uppercase tracking-widest">{item.category}</p>
                                        </div>
                                        <i className="fas fa-star text-[10px] text-amber-500/0 group-hover:text-amber-500/20 transition-all"></i>
                                    </div>
                                ))}
                            </div>
                        )}
                    </main>

                    <footer className="mt-auto py-10 text-slate-700 text-[9px] tracking-[0.5em] uppercase opacity-40">
                        Bollywood Engine &copy; MMXXIV
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
